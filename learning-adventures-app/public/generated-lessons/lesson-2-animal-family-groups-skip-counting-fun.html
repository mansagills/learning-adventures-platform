<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Animal Family Groups: Skip Counting Fun</title>
    <style>
      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }

      body {
        font-family:
          'Comic Sans MS', 'Chalkboard SE', 'Arial Rounded MT Bold', cursive,
          sans-serif;
        background: linear-gradient(135deg, #87ceeb 0%, #98d8c8 100%);
        min-height: 100vh;
        padding: 20px;
        color: #333;
      }

      .container {
        max-width: 1200px;
        margin: 0 auto;
        background: white;
        border-radius: 30px;
        padding: 30px;
        box-shadow: 0 10px 40px rgba(0, 0, 0, 0.2);
      }

      header {
        text-align: center;
        margin-bottom: 30px;
      }

      h1 {
        font-size: 36px;
        color: #ff6b35;
        margin-bottom: 10px;
        text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.1);
      }

      .subtitle {
        font-size: 20px;
        color: #4ecdc4;
        margin-bottom: 20px;
      }

      .instructions {
        background: #fff8dc;
        border: 4px solid #ffd700;
        border-radius: 20px;
        padding: 20px;
        margin-bottom: 30px;
        font-size: 18px;
        line-height: 1.6;
      }

      .progress-bar {
        background: #e0e0e0;
        height: 40px;
        border-radius: 20px;
        margin-bottom: 30px;
        overflow: hidden;
        position: relative;
      }

      .progress-fill {
        background: linear-gradient(90deg, #4caf50, #8bc34a);
        height: 100%;
        width: 0%;
        transition: width 0.5s ease;
        display: flex;
        align-items: center;
        justify-content: center;
        color: white;
        font-weight: bold;
        font-size: 18px;
      }

      .level-selector {
        display: flex;
        justify-content: center;
        gap: 15px;
        margin-bottom: 30px;
        flex-wrap: wrap;
      }

      .level-btn {
        padding: 15px 30px;
        font-size: 20px;
        border: none;
        border-radius: 15px;
        cursor: pointer;
        background: #ffb6c1;
        color: #333;
        font-weight: bold;
        transition: all 0.3s;
        min-width: 120px;
        box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
      }

      .level-btn:hover {
        transform: translateY(-3px);
        box-shadow: 0 6px 12px rgba(0, 0, 0, 0.3);
      }

      .level-btn.active {
        background: #ff69b4;
        color: white;
        transform: scale(1.1);
      }

      .game-area {
        display: none;
        min-height: 400px;
      }

      .game-area.active {
        display: block;
      }

      .challenge-container {
        background: #f0f8ff;
        border-radius: 20px;
        padding: 30px;
        margin-bottom: 30px;
      }

      .challenge-title {
        font-size: 24px;
        color: #ff6b35;
        margin-bottom: 20px;
        text-align: center;
      }

      .animals-source {
        display: flex;
        flex-wrap: wrap;
        gap: 15px;
        justify-content: center;
        margin-bottom: 30px;
        min-height: 120px;
        padding: 20px;
        background: #fffacd;
        border-radius: 15px;
        border: 3px dashed #ffd700;
      }

      .animal {
        width: 70px;
        height: 70px;
        font-size: 50px;
        cursor: grab;
        transition: transform 0.2s;
        user-select: none;
        -webkit-user-select: none;
        -moz-user-select: none;
      }

      .animal:hover {
        transform: scale(1.1);
      }

      .animal.dragging {
        opacity: 0.5;
        cursor: grabbing;
      }

      .groups-container {
        display: flex;
        gap: 20px;
        justify-content: center;
        flex-wrap: wrap;
      }

      .group-box {
        background: white;
        border: 4px solid #4ecdc4;
        border-radius: 15px;
        padding: 20px;
        min-width: 150px;
        min-height: 200px;
        text-align: center;
      }

      .group-box.drag-over {
        background: #e0f7fa;
        border-color: #00bcd4;
        transform: scale(1.05);
      }

      .group-label {
        font-size: 20px;
        font-weight: bold;
        color: #ff6b35;
        margin-bottom: 15px;
      }

      .group-animals {
        display: flex;
        flex-wrap: wrap;
        gap: 10px;
        justify-content: center;
        min-height: 100px;
      }

      .equation-display {
        background: #ffe4b5;
        border: 3px solid #ffa500;
        border-radius: 15px;
        padding: 20px;
        margin-top: 20px;
        text-align: center;
        font-size: 24px;
        font-weight: bold;
        color: #333;
      }

      .check-btn {
        display: block;
        margin: 30px auto;
        padding: 20px 50px;
        font-size: 24px;
        background: #4caf50;
        color: white;
        border: none;
        border-radius: 20px;
        cursor: pointer;
        font-weight: bold;
        box-shadow: 0 6px 12px rgba(0, 0, 0, 0.3);
        transition: all 0.3s;
        min-width: 200px;
      }

      .check-btn:hover {
        background: #45a049;
        transform: translateY(-3px);
        box-shadow: 0 8px 16px rgba(0, 0, 0, 0.4);
      }

      .check-btn:disabled {
        background: #cccccc;
        cursor: not-allowed;
        transform: none;
      }

      .feedback {
        text-align: center;
        font-size: 28px;
        font-weight: bold;
        padding: 20px;
        border-radius: 15px;
        margin: 20px 0;
        display: none;
      }

      .feedback.correct {
        background: #c8e6c9;
        color: #2e7d32;
        border: 4px solid #4caf50;
        display: block;
      }

      .feedback.incorrect {
        background: #ffcdd2;
        color: #c62828;
        border: 4px solid #f44336;
        display: block;
      }

      .stars {
        text-align: center;
        font-size: 60px;
        margin: 20px 0;
      }

      .next-btn {
        display: none;
        margin: 20px auto;
        padding: 20px 50px;
        font-size: 24px;
        background: #ff6b35;
        color: white;
        border: none;
        border-radius: 20px;
        cursor: pointer;
        font-weight: bold;
        box-shadow: 0 6px 12px rgba(0, 0, 0, 0.3);
        transition: all 0.3s;
      }

      .next-btn:hover {
        background: #ff5722;
        transform: translateY(-3px);
      }

      .completion-screen {
        display: none;
        text-align: center;
        padding: 40px;
      }

      .completion-screen.active {
        display: block;
      }

      .completion-title {
        font-size: 48px;
        color: #4caf50;
        margin-bottom: 20px;
      }

      .completion-message {
        font-size: 24px;
        color: #333;
        margin-bottom: 30px;
        line-height: 1.6;
      }

      .trophy {
        font-size: 120px;
        margin: 30px 0;
        animation: bounce 1s infinite;
      }

      @keyframes bounce {
        0%,
        100% {
          transform: translateY(0);
        }
        50% {
          transform: translateY(-20px);
        }
      }

      .restart-btn {
        padding: 20px 50px;
        font-size: 24px;
        background: #4ecdc4;
        color: white;
        border: none;
        border-radius: 20px;
        cursor: pointer;
        font-weight: bold;
        box-shadow: 0 6px 12px rgba(0, 0, 0, 0.3);
        transition: all 0.3s;
      }

      .restart-btn:hover {
        background: #45b7af;
        transform: translateY(-3px);
      }

      .sound-toggle {
        position: fixed;
        top: 20px;
        right: 20px;
        width: 60px;
        height: 60px;
        border-radius: 50%;
        background: #ffd700;
        border: none;
        font-size: 30px;
        cursor: pointer;
        box-shadow: 0 4px 8px rgba(0, 0, 0, 0.3);
        transition: all 0.3s;
        z-index: 1000;
      }

      .sound-toggle:hover {
        transform: scale(1.1);
      }

      @media (max-width: 768px) {
        h1 {
          font-size: 28px;
        }

        .subtitle {
          font-size: 18px;
        }

        .instructions {
          font-size: 16px;
          padding: 15px;
        }

        .level-btn {
          padding: 12px 20px;
          font-size: 18px;
          min-width: 100px;
        }

        .animal {
          width: 60px;
          height: 60px;
          font-size: 40px;
        }

        .group-box {
          min-width: 120px;
        }

        .check-btn,
        .next-btn,
        .restart-btn {
          padding: 15px 30px;
          font-size: 20px;
        }

        .trophy {
          font-size: 80px;
        }
      }
    </style>
  </head>
  <body>
    <button class="sound-toggle" id="soundToggle" aria-label="Toggle sound">
      üîä
    </button>

    <div class="container">
      <header>
        <h1>ü¶Å Animal Family Groups üêò</h1>
        <div class="subtitle">Skip Counting Safari Adventure!</div>
      </header>

      <div class="instructions">
        <strong>üéØ Your Mission:</strong> Help the animal families find their
        groups! Drag the animals into equal groups, then count by skip counting
        to find how many animals there are in total. Choose your skip counting
        number to begin!
      </div>

      <div class="progress-bar">
        <div class="progress-fill" id="progressBar">0 / 12</div>
      </div>

      <div class="level-selector" id="levelSelector">
        <button class="level-btn" data-skip="2">Count by 2s üê∞</button>
        <button class="level-btn" data-skip="3">Count by 3s üê∏</button>
        <button class="level-btn" data-skip="4">Count by 4s ü¶ã</button>
        <button class="level-btn" data-skip="5">Count by 5s üê†</button>
      </div>

      <div class="game-area" id="gameArea">
        <div class="challenge-container">
          <div class="challenge-title" id="challengeTitle"></div>

          <div class="animals-source" id="animalsSource"></div>

          <div class="groups-container" id="groupsContainer"></div>

          <div class="equation-display" id="equationDisplay">
            Drag animals into groups to see the equation!
          </div>
        </div>

        <button class="check-btn" id="checkBtn">Check My Answer!</button>

        <div class="feedback" id="feedback"></div>
        <div class="stars" id="stars"></div>

        <button class="next-btn" id="nextBtn">Next Challenge! ‚Üí</button>
      </div>

      <div class="completion-screen" id="completionScreen">
        <div class="completion-title">üéâ Amazing Work, Safari Explorer! üéâ</div>
        <div class="trophy">üèÜ</div>
        <div class="completion-message">
          You've mastered skip counting with all the animal families!<br />
          You're a true multiplication champion!<br /><br />
          <strong>‚≠ê Skills Unlocked:</strong><br />
          ‚úì Skip counting by 2s, 3s, 4s, and 5s<br />
          ‚úì Making equal groups<br />
          ‚úì Understanding multiplication<br />
        </div>
        <button class="restart-btn" id="restartBtn">Play Again! üîÑ</button>
      </div>
    </div>

    <script>
      // Game State
      let currentSkip = 0;
      let currentChallenge = 0;
      let completedChallenges = 0;
      let soundEnabled = true;
      let draggedElement = null;

      // Animal emojis for each skip count
      const animalSets = {
        2: ['üê∞', 'üêá'],
        3: ['üê∏', 'üêä', 'ü¶é'],
        4: ['ü¶ã', 'üêõ', 'üêù', 'üêû'],
        5: ['üê†', 'üêü', 'üê°', 'ü¶à', 'üêô'],
      };

      // Challenges for each skip count level
      const challenges = {
        2: [
          { groups: 3, total: 6, animal: 'üê∞' },
          { groups: 4, total: 8, animal: 'üêá' },
          { groups: 5, total: 10, animal: 'üê∞' },
        ],
        3: [
          { groups: 2, total: 6, animal: 'üê∏' },
          { groups: 3, total: 9, animal: 'üêä' },
          { groups: 4, total: 12, animal: 'ü¶é' },
        ],
        4: [
          { groups: 2, total: 8, animal: 'ü¶ã' },
          { groups: 3, total: 12, animal: 'üêõ' },
          { groups: 4, total: 16, animal: 'üêù' },
        ],
        5: [
          { groups: 2, total: 10, animal: 'üê†' },
          { groups: 3, total: 15, animal: 'üêü' },
          { groups: 4, total: 20, animal: 'üê°' },
        ],
      };

      // DOM Elements
      const levelSelector = document.getElementById('levelSelector');
      const gameArea = document.getElementById('gameArea');
      const challengeTitle = document.getElementById('challengeTitle');
      const animalsSource = document.getElementById('animalsSource');
      const groupsContainer = document.getElementById('groupsContainer');
      const equationDisplay = document.getElementById('equationDisplay');
      const checkBtn = document.getElementById('checkBtn');
      const feedback = document.getElementById('feedback');
      const stars = document.getElementById('stars');
      const nextBtn = document.getElementById('nextBtn');
      const progressBar = document.getElementById('progressBar');
      const completionScreen = document.getElementById('completionScreen');
      const restartBtn = document.getElementById('restartBtn');
      const soundToggle = document.getElementById('soundToggle');

      // Sound Effects (using Web Audio API)
      function playSound(frequency, duration) {
        if (!soundEnabled) return;

        const audioContext = new (
          window.AudioContext || window.webkitAudioContext
        )();
        const oscillator = audioContext.createOscillator();
        const gainNode = audioContext.createGain();

        oscillator.connect(gainNode);
        gainNode.connect(audioContext.destination);

        oscillator.frequency.value = frequency;
        oscillator.type = 'sine';

        gainNode.gain.setValueAtTime(0.3, audioContext.currentTime);
        gainNode.gain.exponentialRampToValueAtTime(
          0.01,
          audioContext.currentTime + duration
        );

        oscillator.start(audioContext.currentTime);
        oscillator.stop(audioContext.currentTime + duration);
      }

      function playCorrectSound() {
        playSound(523.25, 0.2);
        setTimeout(() => playSound(659.25, 0.2), 100);
        setTimeout(() => playSound(783.99, 0.3), 200);
      }

      function playIncorrectSound() {
        playSound(200, 0.3);
      }

      function playClickSound() {
        playSound(400, 0.1);
      }

      // Sound Toggle
      soundToggle.addEventListener('click', () => {
        soundEnabled = !soundEnabled;
        soundToggle.textContent = soundEnabled ? 'üîä' : 'üîá';
        playClickSound();
      });

      // Level Selection
      levelSelector.addEventListener('click', (e) => {
        if (e.target.classList.contains('level-btn')) {
          playClickSound();

          // Remove active class from all buttons
          document.querySelectorAll('.level-btn').forEach((btn) => {
            btn.classList.remove('active');
          });

          // Add active class to clicked button
          e.target.classList.add('active');

          // Set current skip count
          currentSkip = parseInt(e.target.dataset.skip);
          currentChallenge = 0;

          // Show game area
          gameArea.classList.add('active');

          // Load first challenge
          loadChallenge();
        }
      });

      // Load Challenge
      function loadChallenge() {
        const challenge = challenges[currentSkip][currentChallenge];

        // Update title
        challengeTitle.textContent = `Make ${challenge.groups} groups of ${currentSkip} ${challenge.animal}`;

        // Clear previous animals and groups
        animalsSource.innerHTML = '';
        groupsContainer.innerHTML = '';
        equationDisplay.textContent =
          'Drag animals into groups to see the equation!';
        feedback.style.display = 'none';
        feedback.className = 'feedback';
        stars.textContent = '';
        nextBtn.style.display = 'none';
        checkBtn.disabled = false;

        // Create animals
        for (let i = 0; i < challenge.total; i++) {
          const animal = document.createElement('div');
          animal.className = 'animal';
          animal.textContent = challenge.animal;
          animal.draggable = true;
          animal.setAttribute('role', 'button');
          animal.setAttribute('aria-label', `Animal ${i + 1}`);
          animal.dataset.index = i;

          animal.addEventListener('dragstart', handleDragStart);
          animal.addEventListener('dragend', handleDragEnd);

          // Touch events for mobile
          animal.addEventListener('touchstart', handleTouchStart);
          animal.addEventListener('touchmove', handleTouchMove);
          animal.addEventListener('touchend', handleTouchEnd);

          animalsSource.appendChild(animal);
        }

        // Create group boxes
        for (let i = 0; i < challenge.groups; i++) {
          const groupBox = document.createElement('div');
          groupBox.className = 'group-box';
          groupBox.dataset.groupIndex = i;

          const label = document.createElement('div');
          label.className = 'group-label';
          label.textContent = `Group ${i + 1}`;

          const groupAnimals = document.createElement('div');
          groupAnimals.className = 'group-animals';
          groupAnimals.dataset.groupIndex = i;

          groupBox.appendChild(label);
          groupBox.appendChild(groupAnimals);
          groupsContainer.appendChild(groupBox);

          // Drag and drop events
          groupBox.addEventListener('dragover', handleDragOver);
          groupBox.addEventListener('drop', handleDrop);
          groupBox.addEventListener('dragleave', handleDragLeave);
        }

        updateProgress();
      }

      // Drag and Drop Handlers
      function handleDragStart(e) {
        draggedElement = e.target;
        e.target.classList.add('dragging');
        e.dataTransfer.effectAllowed = 'move';
      }

      function handleDragEnd(e) {
        e.target.classList.remove('dragging');
      }

      function handleDragOver(e) {
        e.preventDefault();
        e.dataTransfer.dropEffect = 'move';
        e.currentTarget.classList.add('drag-over');
      }

      function handleDragLeave(e) {
        e.currentTarget.classList.remove('drag-over');
      }

      function handleDrop(e) {
        e.preventDefault();
        e.currentTarget.classList.remove('drag-over');

        if (draggedElement) {
          const groupAnimals = e.currentTarget.querySelector('.group-animals');
          if (groupAnimals) {
            groupAnimals.appendChild(draggedElement);
            playClickSound();
            updateEquation();
          }
        }
      }

      // Touch Handlers for Mobile
      let touchStartX, touchStartY;
      let touchElement = null;

      function handleTouchStart(e) {
        touchElement = e.target;
        const touch = e.touches[0];
        touchStartX = touch.clientX;
        touchStartY = touch.clientY;
        touchElement.classList.add('dragging');
      }

      function handleTouchMove(e) {
        e.preventDefault();
      }

      function handleTouchEnd(e) {
        if (!touchElement) return;

        touchElement.classList.remove('dragging');
        const touch = e.changedTouches[0];
        const dropTarget = document.elementFromPoint(
          touch.clientX,
          touch.clientY
        );

        if (dropTarget) {
          const groupBox = dropTarget.closest('.group-box');
          if (groupBox) {
            const groupAnimals = groupBox.querySelector('.group-animals');
            if (groupAnimals) {
              groupAnimals.appendChild(touchElement);
              playClickSound();
              updateEquation();
            }
          }
        }

        touchElement = null;
      }

      // Update Equation Display
      function updateEquation() {
        const challenge = challenges[currentSkip][currentChallenge];
        const groups = document.querySelectorAll('.group-animals');

        let allGroupsFilled = true;
        let groupCounts = [];

        groups.forEach((group) => {
          const count = group.children.length;
          groupCounts.push(count);
          if (count !== currentSkip) {
            allGroupsFilled = false;
          }
        });

        if (allGroupsFilled) {
          const skipSequence = [];
          for (let i = 1; i <= challenge.groups; i++) {
            skipSequence.push(currentSkip * i);
          }
          equationDisplay.innerHTML = `
                    <strong>Skip Counting:</strong> ${skipSequence.join(', ')}<br>
                    <strong>Multiplication:</strong> ${challenge.groups} √ó ${currentSkip} = ?
                `;
        } else {
          equationDisplay.textContent = `Keep going! Put ${currentSkip} animals in each group.`;
        }
      }

      // Check Answer
      checkBtn.addEventListener('click', () => {
        playClickSound();

        const challenge = challenges[currentSkip][currentChallenge];
        const groups = document.querySelectorAll('.group-animals');

        let correct = true;
        groups.forEach((group) => {
          if (group.children.length !== currentSkip) {
            correct = false;
          }
        });

        if (correct) {
          playCorrectSound();
          feedback.className = 'feedback correct';
          feedback.innerHTML = `
                    üéâ Perfect! You made ${challenge.groups} groups of ${currentSkip}!<br>
                    ${challenge.groups} √ó ${currentSkip} = ${challenge.total}
                `;
          feedback.style.display = 'block';
          stars.textContent = '‚≠ê‚≠ê‚≠ê';
          nextBtn.style.display = 'block';
          checkBtn.disabled = true;
          completedChallenges++;
          updateProgress();
        } else {
          playIncorrectSound();
          feedback.className = 'feedback incorrect';
          feedback.innerHTML = `
                    Not quite! Remember: Each group needs exactly ${currentSkip} animals.<br>
                    Try again! üí™
                `;
          feedback.style.display = 'block';

          setTimeout(() => {
            feedback.style.display = 'none';
          }, 3000);
        }
      });

      // Next Challenge
      nextBtn.addEventListener('click', () => {
        playClickSound();
        currentChallenge++;

        if (currentChallenge >= challenges[currentSkip].length) {
          // Check if all levels completed
          if (completedChallenges >= 12) {
            showCompletion();
          } else {
            // Return to level selection
            gameArea.classList.remove('active');
            document.querySelectorAll('.level-btn').forEach((btn) => {
              btn.classList.remove('active');
            });
          }
        } else {
          loadChallenge();
        }
      });

      // Update Progress
      function updateProgress() {
        const total = 12;
        const percentage = (completedChallenges / total) * 100;
        progressBar.style.width = percentage + '%';
        progressBar.textContent = `${completedChallenges} / ${total}`;
      }

      // Show Completion Screen
      function showCompletion() {
        gameArea.classList.remove('active');
        completionScreen.classList.add('active');
        playCorrectSound();
        setTimeout(() => playCorrectSound(), 300);
      }

      // Restart Game
      restartBtn.addEventListener('click', () => {
        playClickSound();
        completedChallenges = 0;
        currentChallenge = 0;
        currentSkip = 0;
        completionScreen.classList.remove('active');
        document.querySelectorAll('.level-btn').forEach((btn) => {
          btn.classList.remove('active');
        });
        updateProgress();
      });

      // Keyboard Navigation
      document.addEventListener('keydown', (e) => {
        if (e.key === 'Enter' || e.key === ' ') {
          if (checkBtn.style.display !== 'none' && !checkBtn.disabled) {
            checkBtn.click();
          } else if (nextBtn.style.display === 'block') {
            nextBtn.click();
          }
        }
      });

      // Initialize
      updateProgress();
    </script>
  </body>
</html>
