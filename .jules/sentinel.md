## 2025-02-17 - [CRITICAL] Path Traversal in File Upload Endpoint
**Vulnerability:** The `/api/internal/save-content` endpoint was vulnerable to Path Traversal via the `fileName` parameter. An attacker could supply a filename like `../../malicious/game.html` to create directories and write files outside the intended directory structure. This vulnerability existed despite having Zip Slip protections, because the *target directory itself* was constructed using unsanitized user input.
**Learning:** Preventing Zip Slip is not enough if the base directory for extraction is user-controlled and unsanitized. Path traversal checks must be applied to ALL user-provided filenames and identifiers used in path construction, not just those coming from within an archive.
**Prevention:** Always sanitize user-provided filenames using strict allowlists (e.g., alphanumeric only) or validated identifiers. Ensure `fileName` does not contain directory separators or `..`. Use utilities like `validateIdentifier` for strict validation of identifiers used as directory names.
